---
- name: Create FMC access policy
  hosts: webservers
  connection: httpapi
  vars:
    credentials: adminapi:Ad+in123
  tasks:
    - name: Create Access Control Policy
      uri:
        url: https://150.1.7.242/api/fmc_config/v1/domain/e276abec-e0f2-11e3-8169-6d9ed49b625f/policy/accesspolicies
        method: POST
        validate_certs: no
        headers:
          Authorization: "{{ credentials }}"
          X-auth-access-token: 6170fec4-3afa-435e-af9b-fb4661255d98
          Accept: application/json
        body:
          type: AccessPolicy
          name: NGIPSansible
          defaultAction:
            action: BLOCK
      register: access_policies
      failed_when: access_policies.status not in [200, 201]  

    - name: Display policies
      debug:
        var: access_policies.json

    - name: Display return content
      debug:
        var: access_policies.content
